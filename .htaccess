<IfModule mod_rewrite.c>
  RewriteEngine On
  
  # Serve .mjs files with correct MIME type
  <IfModule mod_mime.c>
    AddType text/javascript .mjs
  </IfModule>

  # Allow existing files and directories
  RewriteCond %{REQUEST_FILENAME} -f
  RewriteRule ^ - [L]

  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # Route API requests to Laravel backend
  RewriteCond %{REQUEST_URI} ^/api
  RewriteRule ^ backend/public/index.php [L,QSA]

  # Route storage requests to Laravel public storage
  RewriteCond %{REQUEST_URI} ^/storage
  RewriteRule ^storage/(.*)$ backend/public/storage/$1 [L]

  # Route everything else to React
  RewriteRule ^ index.html [L]
</IfModule>

